#include <stdio.h>
#include <stdlib.h>
#include <string.h>


#define NUM_STATES 75
#define NUM_TERMINALS 21
#define NUM_NONTERMINALS 16


//reduce: positive
//shift: negative
//accept: 150
int action_table[NUM_STATES][NUM_TERMINALS] = {
    { -4,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    3 }, //0
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,  150 },
    { -4,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    3 },
    { -4,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    3 },
    {  0, -7,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    1 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    2 },
    {  0,  0, -9,-11,  0,    0,  0,  0,  0,-10,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,-12,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  4,  4,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  4,  0,    4,  4,  0,  0,  4,    4 },

    {-14,  0,  0,  0,  0,    0,  0,  0,  0,  0,   20,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },//10
    {  0,-23,  0,  0,-17,  -18,-19,  0,  0,-22,    0,-24,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  5,  5,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  5,  0,    5,  5,  0,  0,  5,    5 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,  -25,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,-26,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  6,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  7,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  8,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  9,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0, 10,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0, 12,  0,  0,    0,  0,-27,  0,  0,   12,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },//20
    {  0,  0, 14,  0,  0,    0,  0, 14,-28,  0,   14,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,-23,  0,  0,  0,    0,  0,  0,  0,-22,    0,-24,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0, 16,  0,  0,    0,  0, 16, 16,  0,   16,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0, 17,  0,  0,    0,  0, 17, 17,  0,   17,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,-30,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,   22,  0,  0,  0,-32,    0,  0,  0,  0,  0,    0 },
    {  0,-23,  0,  0,  0,    0,  0,  0,  0,-22,    0,-24,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,-23,  0,  0,  0,    0,  0,  0,  0,-22,    0,-24,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,  -35,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {-42,-43,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 24,  0,  -40,-41,  0,  0, 24,    0 },//30
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,   19,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {-44,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0, 11,  0,  0,    0,  0,  0,  0,  0,   11,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0, 13,  0,  0,    0,  0, 13,  0,  0,   13,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0, 15,  0,  0,    0,  0, 15, 15,  0,   15,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,-46,    0 },
    {-42,-43,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 24,  0,  -40,-41,  0,  0, 24,    0 },
    { 25, 25,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 25,  0,   25, 25,  0,  0, 25,    0 },
    {  0,  0,-48,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  0,  0,  0,    0,  0,  0,  0,-49,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },//40
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,-50,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,-51,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,-11,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,-52,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,-53,  0,    0,  0,  0,  0,  0,    0 },
    {  0,-23,  0,  0,-17,  -18,-19,  0,  0,-22,    0,-24,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 23,  0,    0,  0,  0,  0, 23,    0 },
    { 26, 26,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 26,  0,   26, 26,  0,  0, 26,    0 },
    {  0,  0,  0,  0,  0,    0,-56,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  0,  0,  0,    0,-56,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },//50
    {  0,  0, -9,-11,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,   22,  0,  0,  0,-32,    0,  0,  0,  0,  0,    0 },
    { 18,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,   18 },
    {  0,  0,-59,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,  -60,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,   30,  0,  0,  0,  0,    0,  0,-61,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,  -62,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,   21,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 33,  0,    0,  0,  0,  0,  0,    0 },

    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,-63,  0,  0,    0,  0,  0,  0,  0,    0 },//60
    {  0,  0,  0,  0,  0,    0,-56,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,-65,  0,  0,    0,  0,  0,  0,  0,    0 },
    {-42,-43,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 24,  0,  -40,-41,  0,  0, 24,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,   29,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0 },

    {-42,-43,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 24,  0,  -40,-41,  0,  0, 24,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,-68,  0,    0,  0,  0,  0,  0,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,-69,  0,    0,  0,  0,  0,  0,    0 },
    { 32, 32,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 32,  0,   32, 32,  0,-71, 32,    0 },
    { 28, 28,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 28,  0,   28, 28,  0,  0, 28,    0 },

    { 27, 27,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 27,  0,   27, 27,  0,  0, 27,    0 },//70
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,-72,  0,  0,    0,  0,  0,  0,  0,    0 },
    {-42,-43,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 24,  0,  -40,-41,  0,  0, 24,    0 },
    {  0,  0,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0,-74,  0,    0,  0,  0,  0,  0,    0 },
    { 31, 31,  0,  0,  0,    0,  0,  0,  0,  0,    0,  0,  0, 31,  0,   31, 31,  0,  0, 31,    0 }

};

int goto_table[NUM_STATES][NUM_NONTERMINALS] = {
    {0, 1, 2, 0, 0,    0, 0, 0, 3, 0,    0, 0, 0, 0, 0,    0},//0
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 5, 2, 0, 0,    0, 0, 0, 3, 0,    0, 0, 0, 0, 0,    0},
    {0, 6, 2, 0, 0,    0, 0, 0, 3, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 8, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0,13,    0, 0, 0, 0, 0,    0},//10
    {0, 0, 0, 0,15,   16,20,21, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},//20
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,   29,20,21, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,   31, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,   33,20,21, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0,34,21, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0,38,39, 0,    0, 0, 0, 0, 0,    0,36,37, 0, 0,    0},//30
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,   45},
    {0, 0,38,39, 0,    0, 0, 0, 0, 0,    0,47,37, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},//40
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 8, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0,54,   16,20,21, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0,55, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0,57, 0,    0},//50
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,   58, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},//60
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0,64, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0,38,39, 0,    0, 0, 0, 0, 0,    0,66,37, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0,38,39, 0,    0, 0, 0, 0, 0,    0,67,37, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0,70, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},

    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},//70
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0,38,39, 0,    0, 0, 0, 0, 0,    0,73,37, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0},
    {0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0, 0, 0, 0, 0,    0}
};

typedef struct {
    int lhs;
    int rhs_len;
} Rule;

//starting from number 1
Rule rules[] = {
    { 1, 1 },//START
    
    { 2, 2 },//CODE
    { 2, 2 },
    { 2, 0 },
    
    { 3, 3 },//VDECL
    { 3, 3 },

    { 4, 3 },//ASSIGN

    { 5, 1 },//RHS
    { 5, 1 },
    { 5, 1 },
    { 5, 1 },
    
    { 6, 3 },//EXPR
    { 6, 1 },
    
    { 7, 3 },//EXPR_T
    { 7, 1 },

    { 8, 3 },//EXPR_F
    { 8, 1 },
    { 8, 1 },
    
    { 9, 9 },//FDECL

    { 10, 3 },//ARG
    { 10, 0 },

    { 11, 4 },//MOREARGS
    { 11, 0 },

    { 12, 2 },//BLOCK
    { 12, 0 },

    { 13, 1 },//STMT
    { 13, 2 },
    { 13, 8 },
    { 13, 7 },

    { 14, 3 },//COND
    { 14, 1 },

    { 15, 4 },//ELSE
    { 15, 0 },

    { 16, 3 },//RETURN

};


#define MAX_STACK_SIZE 200
int stack[MAX_STACK_SIZE];
int top = -1;

void push(int state) {
    if (top < MAX_STACK_SIZE - 1) {
        stack[++top] = state;
    } else {
        printf("Stack overflow\n");
    }
}

int pop() {
    if (top >= 0) {
        return stack[top--];
    } else {
        printf("Stack underflow\n");
        return -1;
    }
}

int get_top() {
    if (top >= 0) {
        return stack[top];
    } else {
        printf("Stack underflow\n");
        exit(0);
    }
}

int get_symbol(char* token) {
    if(strcmp(token, "vtype")==0) return 0;
    if(strcmp(token, "id")==0) return 1;
    if(strcmp(token, "semi")==0) return 2;
    if(strcmp(token, "assign")==0) return 3;
    if(strcmp(token, "literal")==0) return 4;

    if(strcmp(token, "character")==0) return 5;
    if(strcmp(token, "boolstr")==0) return 6;
    if(strcmp(token, "addsub")==0) return 7;
    if(strcmp(token, "multdiv")==0) return 8;
    if(strcmp(token, "lparen")==0) return 9;

    if(strcmp(token, "rparen")==0) return 10;
    if(strcmp(token, "num")==0) return 11;
    if(strcmp(token, "lbrace")==0) return 12;
    if(strcmp(token, "rbrace")==0) return 13;
    if(strcmp(token, "comma")==0) return 14;

    if(strcmp(token, "if")==0) return 15;
    if(strcmp(token, "while")==0) return 16;
    if(strcmp(token, "comp")==0) return 17;
    if(strcmp(token, "else")==0) return 18;
    if(strcmp(token, "return")==0) return 19;
    
}

void parse(char *input) {
    push(0);
    
    int state, symbol;

    char *token;

    token = strtok(input, " ");

    while (1) {
        if(token == NULL) {
            symbol = 20;
        }
        else symbol = get_symbol(token);
        state = stack[top];
        int action = action_table[state][symbol];

        if(action == 0){ //error
            printf("Error: in token %s\n", token);
            return;
        }
        else if(action > 0) {// reduction
            printf("Reduce by rule %d\n", action);
            Rule rule = rules[action];

            for(int i = 0; i < rule.rhs_len; i++){
                pop();
            }
            int goto_state = goto_table[get_top()][rule.lhs - 1];
            push(goto_state);

        }
        else if(action == 150){
            printf("Accepted\n");
            return;
        }
        else{ //shift
            printf("Shift and go to state %d\n", -action);
            push(-action);
            token = strtok(NULL, " ");
        }
        if(get_top() == 0 && token==NULL) break;
        
    }
    
}

int main(int argc, char* argv[]) {
    FILE *fp;
    fp = fopen(argv[1], "r");

    char input[500];

    fgets(input, sizeof(input), fp);

    parse(input);

    return 0;
}
